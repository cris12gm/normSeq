{% extends "base.html" %}
{% load static %}

{% block css %}
<link href="{% static 'css/customStyles/stylesQuery.css'%}" rel="stylesheet">
{% endblock %}

{% block modals %}
    {% include "modals/query/chooseInput.html" %}
    {% include "modals/query/chooseMethod.html" %}
    {% include "modals/query/uploadAnnotation.html" %}
    {% include "modals/query/chooseAnnotation.html" %}
    {% include "modals/query/chooseParameters.html" %}
{% endblock %}

{% load crispy_forms_tags %}    

{% block content %}

<div class="menu-hide" id="menu-hide">
    <div class="d-flex justify-content-center mt-3">
        <img id="titleIndex" width="40%" src="{% static 'images/titleBig.png'%}">
    </div>
    
    <hr>
    <div class="row">
        <div class="col-md-11"style="float:none;margin:auto;">
            <div class="card">
                <div class="card-body">
                    <div class="text-center">
                        <div class="btn-group btn-group-lg mr-3" role="group" id="aBtnGroup" aria-label="Basic example">
                            <button type="button" value="miRNA" name="miRNA" class="btn btn-info">miRNA</button>
                            <button type="button" value="mRNA" name="mRNA" class="btn btn-info">mRNA</button>
                            <button type="button" value="tRNA" name="tRNA" class="btn btn-info">tRNA</button>
                            <button type="button" value="feature" name="Other" class="btn btn-info">Other</button>
                        </div>
                        <div class="btn-group btn-group-lg">
                            <button type="button" id="loadEx" name="Example Data" class="btn btn-warning ml-3">Load Example Data</button>
                            <button type="button" class="btn btn-light"><i class="fas fa-solid fa-question" style="color:#f0ad4e;"></i></button>
                        </div>
                        <h5 id="ExampleLoaded" class="mt-2" style="color:#041C34;"></h5>
                    </div>
                    <h3 id="selectedRNA">
                    </h3>
                    <br>
                    <div id="formMirna" style="display:block;">
                        {% crispy form %}
                    </div>
                </div>
            </div>
            <div class='form-group'>
            </div>  
        </div>
    </div>
</div>
{% endblock %}

{% block js %}

<script>
    $(document).ready(
        function() {
              // Get click event, assign button to var, and get values from that var
                $('#aBtnGroup button').on('click', function() {
                    var thisBtn = $(this);
                    
                    thisBtn.addClass('active').siblings().removeClass('active');
                    var btnValue = thisBtn.val();
                    
                    if (btnValue=="feature") {
                        var name = "Other"
                    }
                    else{
                        var name = btnValue;
                    }
                    // document.getElementById("RNAselected").innerHTML = "<b>RNA class: </b>"+name;
                    document.getElementById("selectedRNA").innerHTML = name;
                    document.getElementById("id_typeJob").value = btnValue;

                }); 
                $('#aBtnGroup button[value="miRNA"]').click();
    });
    
</script>


<script>
    $(document).ready(
        function() {
            var jobIDValue = document.getElementById("id_jobID");
            jobIDValue.value = "{{ jobID }}";
            document.getElementById("divFileBatch").style.display="none";
        });

</script>

<!-- Load example data -->
<script type="text/javascript">
     $('#loadEx').on('click', function(){
        $('#aBtnGroup button[value="miRNA"]').click();
        $('#id_url').val("https://arn.ugr.es/normSeq/static/testFiles/exampleMatrix.txt");
        $('[href="#url"]').tab('show');
        $('#id_annotationURL').val("http://arn.ugr.es/normSeq/static/testFiles/templateExample.txt");
        $('[href="#annotation_url"]').tab('show');
        var ele=document.getElementsByName('methods');  
                for(var i=0; i<ele.length; i++){  
                    if(ele[i].type=='checkbox' && ele[i].value=='NN' | ele[i].value=='CPM' | ele[i].value=='QN'){
                        ele[i].checked=true;
                    }
                    
                }     
        document.getElementById("ExampleLoaded").innerHTML = "Example data was loaded";

   });
</script>

<script>
    $('#id_batchEffect').change(function(){ 
            valor = this.value;
            if (valor == 'True'){
                document.getElementById("divFileBatch").style.display="block";
            }
            if (valor == 'False' ){
                document.getElementById("divFileBatch").style.display="none";
            }
            
        });
</script>

<script>
    $('.select-all').click(function(){
        var ele=document.getElementsByName('methods');  
                for(var i=0; i<ele.length; i++){  
                    if(ele[i].type=='checkbox')  
                        ele[i].checked=true;  
                }  
    });
    $('.deselect-all').click(function(){
        var ele=document.getElementsByName('methods');  
        for(var i=0; i<ele.length; i++){  
                    if(ele[i].type=='checkbox')  
                        ele[i].checked=false;  
                }
            });
</script>

{% endblock %}